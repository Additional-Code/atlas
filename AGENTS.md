# Repository Guidelines

## Project Structure & Module Organization
This Go module (`github.com/Additional-Code/atlas`) organizes runtime entrypoints under `cmd/<service>` and domain code under `internal/<domain>`. Shared libraries belong in `pkg/`. Scaffolding via `atlas module create` populates REST, gRPC, repository, and worker stubs—extend code within the generated module rather than relocating files. Documentation and architecture notes live in `docs/` (see `PRD.md`, `TRD.md`). Protobuf definitions reside in `proto/` as generated by `atlas grpc create`.

## Build, Test, and Development Commands
Use `make dev` to start the local stack (Echo, gRPC, DB, Redis, Kafka) with hot reload. `go build ./...` verifies compilation when CI is unavailable. Run `atlas test` for the full unit/integration suite; use `go test ./internal/orders/...` for focused packages. Database migrations run with `atlas migrate up` and seeds with `atlas seed run`. Workers can be exercised via `atlas worker run --queue=<name>`.

## Coding Style & Naming Conventions
Apply `gofmt` (or `goimports`) before committing and keep imports grouped stdlib/third-party/internal. Package directories remain lower-case and short (`orders`, `billing`). Exported identifiers use PascalCase; internal helpers use lowerCamelCase. Favor Fx modules for wiring—new services should register constructors in `internal/<domain>/module.go`. Keep configuration keys kebab-case within YAML/JSON files.

## Testing Guidelines
Unit tests live alongside code with `_test.go` suffix. Integration and E2E tests use Testcontainers; guard them with build tags such as `//go:build integration`. Aim for meaningful coverage on service and repository layers; add assertions on logging/tracing fields when relevant. When adding migrations, include a seed or fixture to exercise them. Run `atlas test` before pushes and in CI ensure `go test ./... -cover` remains green.

## Commit & Pull Request Guidelines
Write commits in imperative mood (`Add user service handler`), scoped to a single concern. Reference issues using `Refs #123` or `Fixes #123` when applicable. Pull requests should describe architecture impact, outline testing performed, and attach CLI output or screenshots for observable changes (Swagger, metrics dashboards). Request review once linting and tests pass; label PRs with the affected modules and note any follow-up tasks.

## Security & Configuration Tips
Store secrets in environment variables or a managed secret store—never commit `.env` files. Keep default configs minimal and document overrides in `docs/`. Vet new external dependencies for licensing and security posture; prefer existing Fx modules before adding new clients.
